import{a as r,j as e,c as pe}from"./index-Q695sD3D.js";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),ge=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(n,c,d)=>d?d.toUpperCase():c.toLowerCase()),ae=t=>{const n=ge(t);return n.charAt(0).toUpperCase()+n.slice(1)},se=(...t)=>t.filter((n,c,d)=>!!n&&n.trim()!==""&&d.indexOf(n)===c).join(" ").trim(),xe=t=>{for(const n in t)if(n.startsWith("aria-")||n==="role"||n==="title")return!0};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var ue={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=r.forwardRef(({color:t="currentColor",size:n=24,strokeWidth:c=2,absoluteStrokeWidth:d,className:b="",children:g,iconNode:m,...h},f)=>r.createElement("svg",{ref:f,...ue,width:n,height:n,stroke:t,strokeWidth:d?Number(c)*24/Number(n):c,className:se("lucide",b),...!g&&!xe(h)&&{"aria-hidden":"true"},...h},[...m.map(([v,k])=>r.createElement(v,k)),...Array.isArray(g)?g:[g]]));/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w=(t,n)=>{const c=r.forwardRef(({className:d,...b},g)=>r.createElement(me,{ref:g,iconNode:n,className:se(`lucide-${he(ae(t))}`,`lucide-${t}`,d),...b}));return c.displayName=ae(t),c};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],be=w("chevron-down",fe);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],ye=w("chevron-right",ve);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const we=[["path",{d:"m7 6 5 5 5-5",key:"1lc07p"}],["path",{d:"m7 13 5 5 5-5",key:"1d48rs"}]],ke=w("chevrons-down",we);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=[["path",{d:"m17 11-5-5-5 5",key:"e8nh98"}],["path",{d:"m17 18-5-5-5 5",key:"2avn1x"}]],je=w("chevrons-up",Ne);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Se=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Ce=w("loader-circle",Se);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ze=[["line",{x1:"2",x2:"5",y1:"12",y2:"12",key:"bvdh0s"}],["line",{x1:"19",x2:"22",y1:"12",y2:"12",key:"1tbv5k"}],["line",{x1:"12",x2:"12",y1:"2",y2:"5",key:"11lu5j"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}],["circle",{cx:"12",cy:"12",r:"7",key:"fim9np"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Ie=w("locate-fixed",ze);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ee=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],$e=w("mail",Ee);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ae=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],Me=w("map-pin",Ae);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _e=[["rect",{x:"16",y:"16",width:"6",height:"6",rx:"1",key:"4q2zg0"}],["rect",{x:"2",y:"16",width:"6",height:"6",rx:"1",key:"8cvhb9"}],["rect",{x:"9",y:"2",width:"6",height:"6",rx:"1",key:"1egb70"}],["path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3",key:"1jsf9p"}],["path",{d:"M12 12V8",key:"2874zd"}]],Le=w("network",_e);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Re=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],Te=w("phone",Re);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const De=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],Pe=w("rotate-ccw",De);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Be=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],Ge=w("search",Be);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fe=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Oe=w("triangle-alert",Fe);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const He=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],qe=w("user",He);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ue=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Ve=w("x",Ue);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ye=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],Ze=w("zoom-in",Ye);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xe=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],We=w("zoom-out",Xe),Ke=({data:t,onSelect:n})=>{const[c,d]=r.useState(""),[b,g]=r.useState(!1),m=r.useRef(null),h=r.useMemo(()=>{const i=[],s=S=>{S&&S.forEach(u=>{i.push({name:u.name,title:u.title,department:u.department,id:u.distinguishedName,distinguishedName:u.distinguishedName}),u.children&&s(u.children)})};return s(t),i},[t]),f=r.useMemo(()=>{if(!c||c.length<2)return[];const i=c.toLowerCase();return h.filter(s=>s.name&&s.name.toLowerCase().includes(i)).slice(0,8)},[c,h]);r.useEffect(()=>{const i=s=>{m.current&&!m.current.contains(s.target)&&g(!1)};return document.addEventListener("mousedown",i),()=>document.removeEventListener("mousedown",i)},[]);const v=i=>{d(i.name),g(!1),n(i.id)},k=()=>{d(""),g(!1)};return e.jsxs("div",{className:"search-component",ref:m,children:[e.jsxs("div",{className:`search-input-wrapper ${b?"active":""}`,children:[e.jsx(Ge,{size:16,className:"search-icon"}),e.jsx("input",{type:"text",placeholder:"Buscar colaborador...",value:c,onChange:i=>{d(i.target.value),g(!0)},onFocus:()=>g(!0)}),c&&e.jsx("button",{className:"clear-btn",onClick:k,children:e.jsx(Ve,{size:14})})]}),b&&f.length>0&&e.jsx("div",{className:"search-dropdown",children:f.map(i=>e.jsxs("div",{className:"search-item",onClick:()=>v(i),children:[e.jsx("div",{className:"item-avatar",children:e.jsx(qe,{size:16})}),e.jsxs("div",{className:"item-info",children:[e.jsx("span",{className:"item-name",children:i.name}),e.jsxs("span",{className:"item-meta",children:[i.title," • ",i.department]})]})]},i.id))}),b&&c.length>=2&&f.length===0&&e.jsx("div",{className:"search-dropdown empty",children:e.jsx("span",{children:"Nenhum resultado encontrado"})}),e.jsx("style",{children:`
                .search-component {
                    position: relative;
                    width: 300px;
                }
                .search-input-wrapper {
                    display: flex;
                    align-items: center;
                    background: #fff;
                    border: 1px solid #e2e8f0;
                    border-radius: 8px;
                    padding: 8px 12px;
                    transition: all 0.2s;
                    position: relative;
                }
                .search-input-wrapper:focus-within {
                    border-color: #3b82f6;
                    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
                }
                .search-icon {
                    color: #94a3b8;
                    margin-right: 8px;
                }
                .search-input-wrapper input {
                    border: none;
                    outline: none;
                    width: 100%;
                    font-size: 0.9rem;
                    color: #0f172a;
                }
                .clear-btn {
                    background: none;
                    border: none;
                    color: #94a3b8;
                    cursor: pointer;
                    display: flex;
                    align-items: center;
                    padding: 4px;
                }
                .clear-btn:hover { color: #64748b; }

                .search-dropdown {
                    position: absolute;
                    top: 100%;
                    left: 0;
                    right: 0;
                    margin-top: 8px;
                    background: #fff;
                    border: 1px solid #e2e8f0;
                    border-radius: 8px;
                    box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
                    max-height: 300px;
                    overflow-y: auto;
                    z-index: 100;
                    padding: 4px;
                }
                .search-item {
                    display: flex;
                    align-items: center;
                    gap: 12px;
                    padding: 8px 12px;
                    border-radius: 6px;
                    cursor: pointer;
                    transition: background 0.15s;
                }
                .search-item:hover {
                    background: #f1f5f9;
                }
                .item-avatar {
                    width: 32px;
                    height: 32px;
                    background: #e2e8f0;
                    border-radius: 50%;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    color: #64748b;
                }
                .item-info {
                    display: flex;
                    flex-direction: column;
                    overflow: hidden;
                }
                .item-name {
                    font-weight: 500;
                    font-size: 0.9rem;
                    color: #0f172a;
                }
                .item-meta {
                    font-size: 0.75rem;
                    color: #64748b;
                    white-space: nowrap;
                    overflow: hidden;
                    text-overflow: ellipsis;
                }
                .search-dropdown.empty {
                    padding: 16px;
                    text-align: center;
                    color: #94a3b8;
                    font-size: 0.9rem;
                }
            `})]})},ee=r.createContext({hoveredNodeId:null,setHoveredNodeId:()=>{},focusedNodeId:null,setFocusedNodeId:()=>{},ancestorIds:new Set,setTooltipData:()=>{}}),ne=["#059669","#d97706","#2563eb","#db2777","#7c3aed","#ea580c","#0891b2","#4f46e5","#dc2626","#65a30d"],J=t=>ne[t%ne.length],Qe=t=>{if(!t)return"";const n=t.split(" ");return n.length>=2?`${n[0][0]}${n[n.length-1][0]}`.toUpperCase():t[0].toUpperCase()},Je=({data:t,expandedNodes:n,hoveredNodeId:c,focusedNodeId:d,zoom:b})=>{const[g,m]=r.useState({staticPaths:[],activePaths:[]});return r.useEffect(()=>{const h=()=>{const k=[],i=[],s=c||d,S=new Map,u=new Set,C=(p,E=null)=>{const N=[];p.forEach(x=>{E&&S.set(x.distinguishedName,E),!x.children||x.children.length===0?N.push(x):x.children&&C(x.children,x.distinguishedName)}),p.length>3&&N.length>0&&N.forEach(x=>u.add(x.distinguishedName))};C(t);const y=new Set;if(s){let p=s;for(;p;)y.add(p),p=S.get(p)}const T=(p,E)=>{if(!p)return;const $=p.distinguishedName;if(E){const N=u.has($);let x;if(N){const M=`aggregate-${E}`;x=document.getElementById(M)}else x=document.getElementById($);const L=document.getElementById(E);if(x&&L){const M=x.getBoundingClientRect(),P=L.getBoundingClientRect(),z=M.left+M.width/2,O=M.top,Y=P.left+P.width/2,H=P.bottom,Z=(O+H)/2,X=`M ${z} ${O} V ${Z} H ${Y} V ${H}`;let B=!1;N?s&&u.has(s)&&S.get(s)===E&&(B=!0):B=y.has($);const W=N?`agg-${E}`:$,q={d:X,key:W,isActive:B};B?i.push(q):k.push(q)}}n.has($)&&p.children&&p.children.forEach(N=>T(N,$))};t.forEach(p=>T(p,null));const I=Array.from(new Map(k.map(p=>[p.key,p])).values()),D=Array.from(new Map(i.map(p=>[p.key,p])).values());m({staticPaths:I,activePaths:D})},f=()=>{h(),requestAnimationFrame(f)},v=requestAnimationFrame(f);return()=>cancelAnimationFrame(v)},[t,n,c,d,b]),e.jsxs("svg",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",pointerEvents:"none",zIndex:1},children:[g.staticPaths.map(h=>e.jsx("path",{d:h.d,stroke:"#cbd5e1",strokeWidth:"2",fill:"none",strokeLinecap:"round"},h.key)),g.activePaths.map(h=>e.jsx("path",{d:h.d,stroke:"#3b82f6",strokeWidth:"3",fill:"none",strokeLinecap:"round",style:{filter:"drop-shadow(0 0 4px rgba(59, 130, 246, 0.5))",zIndex:40}},h.key))]})},et=({nodes:t,parentName:n,assignedColor:c,parentId:d})=>{const[b,g]=r.useState(!1),{focusedNodeId:m,hoveredNodeId:h}=r.useContext(ee),f=r.useMemo(()=>t.some(s=>s.distinguishedName===m||s.distinguishedName===h),[t,m,h]);r.useEffect(()=>{m&&t.some(S=>S.distinguishedName===m)&&g(!0)},[m,t]);const v=12,k=b?t:t.slice(0,v),i=t.length>v;return e.jsxs("div",{className:"aggregate-box-wrapper",id:`aggregate-${d}`,children:[e.jsx("div",{className:`connector-vertical-aggregate ${f?"active":""}`}),e.jsxs("div",{className:`aggregate-box ${f?"box-active":""}`,children:[e.jsx("div",{className:"aggregate-header",children:e.jsxs("h5",{children:["Pessoas que respondem a ",n," (",t.length,")"]})}),e.jsx("div",{className:"aggregate-grid",children:k.map(s=>e.jsx(ie,{node:s,isGridItem:!0,hasChildren:!1,isExpanded:!1,toggleNode:()=>{},isMatch:!1,parentId:null,assignedColor:c},s.distinguishedName))}),i&&e.jsx("div",{className:"aggregate-footer",children:e.jsx("button",{className:"btn-view-more",onClick:()=>g(!b),children:b?"Visualizar menos":"Visualizar mais"})})]})]})},ie=({node:t,isExpanded:n,toggleNode:c,hasChildren:d,isMatch:b,parentId:g,isGridItem:m,assignedColor:h})=>{const{hoveredNodeId:f,setHoveredNodeId:v,focusedNodeId:k,setFocusedNodeId:i,ancestorIds:s,setTooltipData:S}=r.useContext(ee),u=h||"#64748b",C=t.distinguishedName,y=f===C,T=k===C,I=f===g&&f!==null,D=s.has(C),$=(f!==null||k!==null)&&!(y||T||I||D),N=t.title&&(t.title.toLowerCase().includes("presidente")||t.title.toLowerCase().includes("ceo")||t.title.toLowerCase().includes("diretor")),x=r.useRef(null),L=z=>{z.stopPropagation(),v(C),x.current&&clearTimeout(x.current),x.current=setTimeout(()=>{S({node:t,x:z.clientX,y:z.clientY})},800)},M=()=>{v(null),x.current&&clearTimeout(x.current),S(null)},P=z=>{(z.key==="Enter"||z.key===" ")&&(z.preventDefault(),i(C),d&&c())};return e.jsxs("div",{id:C,className:`
                org-card
                ${m?"card-grid":""}
                ${b?"highlight":""}
                ${N?"executive":""}
                ${y?"state-active":""}
                ${T?"state-focused":""}
                ${I?"state-subordinate":""}
                ${D?"state-ancestor":""}
                ${$?"state-dimmed":""}
            `,onClick:z=>{z.stopPropagation(),i(C),d&&c()},onKeyDown:P,onMouseEnter:L,onMouseLeave:M,style:{"--dept-color":u},role:"button","aria-expanded":n,"aria-label":`${t.name}, ${t.title}`,tabIndex:0,children:[e.jsx("div",{className:"card-accent"}),e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"card-header",children:[e.jsx("div",{className:"avatar",style:{backgroundColor:N?"#0f172a":`${u}10`,color:N?"#fff":u},children:Qe(t.name)}),e.jsxs("div",{className:"info",children:[e.jsx("h6",{className:"name",title:t.name,children:t.name}),e.jsx("p",{className:"role",title:t.title,children:t.title||"Cargo não definido"})]})]}),t.department&&e.jsx("div",{className:"card-footer",children:e.jsx("span",{className:"dept-badge",style:{backgroundColor:`${u}08`,color:u,borderColor:`${u}20`},children:t.department})})]}),d&&e.jsx("div",{className:`toggle-btn ${n?"expanded":""}`,children:e.jsx(be,{size:14,className:"icon-chevron"})})]})},tt=()=>{const[t,n]=r.useState([]),[c,d]=r.useState(!0),[b,g]=r.useState(null),[m,h]=r.useState(1),[f,v]=r.useState(new Set),[k,i]=r.useState(null),[s,S]=r.useState(null),[u,C]=r.useState(new Set),[y,T]=r.useState(null),I=r.useRef(null),[D,p]=r.useState(!1),[E,$]=r.useState({x:0,y:0}),[N,x]=r.useState({left:0,top:0});r.useEffect(()=>{fetch("/api/public/organogram_data").then(o=>{if(!o.ok)throw new Error("Falha ao carregar dados");return o.json()}).then(o=>{const a=Array.isArray(o)?o:[];n(a);const l=new Set;a.forEach((j,_)=>{const R=j.distinguishedName||_;l.add(R)}),v(l),d(!1)}).catch(o=>{g(o.message),d(!1)})},[]);const L=(o,a,l=[])=>{for(const j of o){const _=j.distinguishedName;if(_===a)return[...l,_];if(j.children){const R=L(j.children,a,[...l,_]);if(R)return R}}return null};r.useEffect(()=>{const o=k||s;if(o){const a=L(t,o);C(a?new Set(a):new Set)}else C(new Set)},[k,s,t]),r.useEffect(()=>{const o=I.current;if(!o)return;const a=l=>{l.ctrlKey||l.metaKey;{l.preventDefault();const j=-l.deltaY*.001;h(_=>Math.min(Math.max(_+j,.4),2))}};return o.addEventListener("wheel",a,{passive:!1}),()=>o.removeEventListener("wheel",a)},[]),r.useEffect(()=>{if(s){setTimeout(()=>{const a=document.getElementById(s);a&&a.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})},100);const o=setTimeout(()=>{S(null)},3e3);return()=>clearTimeout(o)}},[s]);const M=o=>{I.current&&(p(!0),$({x:o.pageX,y:o.pageY}),x({left:I.current.scrollLeft,top:I.current.scrollTop}))},P=o=>{if(!D||!I.current)return;o.preventDefault();const a=o.pageX-E.x,l=o.pageY-E.y;I.current.scrollLeft=N.left-a,I.current.scrollTop=N.top-l},z=()=>{p(!1)},O=o=>{v(a=>{const l=new Set(a);return l.has(o)?l.delete(o):l.add(o),l})},Y=()=>{const o=new Set,a=l=>{l&&l.forEach(j=>{o.add(j.distinguishedName),j.children&&a(j.children)})};a(t),v(o)},H=()=>{const o=new Set;t.forEach(a=>o.add(a.distinguishedName)),v(o)},Z=o=>{const a=L(t,o);a&&v(l=>new Set([...l,...a])),S(o)},X=()=>h(o=>Math.min(o+.1,2)),B=()=>h(o=>Math.max(o-.1,.4)),W=()=>h(1),q=()=>{if(s){const o=document.getElementById(s);o&&o.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})}},te=(o,a=null,l=null,j=0)=>{if(!o||!Array.isArray(o)||o.length===0)return null;const _=3,R=[],U=[];o.forEach(A=>{A.children&&A.children.length>0?R.push(A):U.push(A)});const ce=o.length>_&&U.length>0;let V=[];return ce?(R.sort((A,G)=>A.name.localeCompare(G.name)),V=[...R],U.length>0&&V.push({isAggregate:!0,nodes:U,distinguishedName:`aggregate-${a?a.distinguishedName:"root"}`})):V=o,e.jsx("ul",{className:"org-tree",style:{display:"flex",justifyContent:"center"},children:V.map((A,G)=>{if(A.isAggregate){const le=A.distinguishedName,de=l||J(G+j);return e.jsxs("li",{className:"org-leaf",children:[e.jsx("div",{className:"connector-vertical"}),e.jsx(et,{nodes:A.nodes,parentName:a?a.name:"Unknown",assignedColor:de,parentId:a?a.distinguishedName:"root"})]},le)}const F=A,K=F.distinguishedName||G,Q=F.children&&F.children.length>0,oe=f.has(K),re=Q?J(G+j):l||J(G+j);return e.jsxs("li",{className:"org-leaf",children:[e.jsx("div",{className:"connector-vertical"}),e.jsx(ie,{node:F,isExpanded:oe,toggleNode:()=>O(K),hasChildren:Q,isMatch:!1,parentId:a?a.distinguishedName:null,assignedColor:re}),Q&&oe&&te(F.children,F,re,j+1)]},K)})})};return c?e.jsxs("div",{className:"loading-container",children:[e.jsx(Ce,{className:"spinner",size:40}),e.jsx("p",{children:"Carregando estrutura..."})]}):b?e.jsxs("div",{className:"error-container",children:[e.jsx(Oe,{size:48,className:"text-red-500"}),e.jsxs("p",{children:["Erro ao carregar: ",b]})]}):e.jsx(ee.Provider,{value:{hoveredNodeId:k,setHoveredNodeId:i,focusedNodeId:s,setFocusedNodeId:S,ancestorIds:u,setTooltipData:T},children:e.jsxs("div",{className:"organogram-page",children:[e.jsx(Je,{data:t,expandedNodes:f,hoveredNodeId:k,focusedNodeId:s,zoom:m}),e.jsxs("header",{className:"page-header",children:[e.jsxs("div",{className:"brand",children:[e.jsx("div",{className:"brand-icon",children:e.jsx(Le,{size:20})}),e.jsxs("div",{className:"brand-text",children:[e.jsx("h2",{children:"Organograma"}),e.jsx("span",{children:"Corporativo"})]})]}),e.jsxs("div",{className:"actions",children:[e.jsx(Ke,{data:t,onSelect:Z}),e.jsxs("div",{className:"zoom-controls",children:[e.jsx("button",{onClick:Y,title:"Expandir Tudo",children:e.jsx(ke,{size:16})}),e.jsx("button",{onClick:H,title:"Recolher Tudo",children:e.jsx(je,{size:16})}),e.jsx("div",{className:"separator"}),e.jsx("button",{onClick:q,disabled:!s,title:"Centralizar Seleção",style:{opacity:s?1:.4},children:e.jsx(Ie,{size:16})}),e.jsx("div",{className:"separator"}),e.jsx("button",{onClick:B,title:"Reduzir Zoom",children:e.jsx(We,{size:16})}),e.jsxs("span",{className:"zoom-level",children:[Math.round(m*100),"%"]}),e.jsx("button",{onClick:X,title:"Aumentar Zoom",children:e.jsx(Ze,{size:16})}),e.jsx("div",{className:"separator"}),e.jsx("button",{onClick:W,title:"Resetar",children:e.jsx(Pe,{size:14})})]})]})]}),e.jsx("main",{className:`canvas ${D?"grabbing":""}`,ref:I,onMouseDown:M,onMouseMove:P,onMouseUp:z,onMouseLeave:z,children:e.jsx("div",{className:"tree-wrapper",style:{transform:`scale(${m})`},children:te(t,null)})}),y&&e.jsxs("div",{className:"node-tooltip",style:{left:y.x+20,top:y.y+20},children:[e.jsxs("div",{className:"tooltip-header",children:["Contato ",e.jsx(ye,{size:14})]}),y.node.mail&&e.jsxs("div",{className:"tooltip-row",children:[e.jsx($e,{size:16,className:"icon-tooltip"}),e.jsx("a",{href:`mailto:${y.node.mail}`,className:"tooltip-link",children:y.node.mail})]}),y.node.telephoneNumber&&e.jsxs("div",{className:"tooltip-row",children:[e.jsx(Te,{size:16,className:"icon-tooltip"}),e.jsx("a",{href:`tel:${y.node.telephoneNumber}`,className:"tooltip-link",children:y.node.telephoneNumber})]}),y.node.office&&e.jsxs("div",{className:"tooltip-row",children:[e.jsx(Me,{size:16,className:"icon-tooltip"}),e.jsx("span",{className:"tooltip-text",children:y.node.office})]})]}),e.jsx("style",{children:`
                    /* --- Fonts & Vars --- */
                    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');

                    :root {
                        --bg-page: #f8fafc; /* Slate 50 */
                        --bg-card: #FAFAFB; /* Off-white premium */
                        --text-primary: #1e293b; /* Slate 800 */
                        --text-secondary: #64748b; /* Slate 500 */
                        --border-color: #e2e8f0; /* Slate 200 */
                        --line-color: #cbd5e1; /* Slate 300 */
                        --line-active: #3b82f6; /* Blue 500 */

                        /* Shadows - Premium Depth */
                        --shadow-sm: 0 2px 4px rgba(0,0,0,0.02), 0 1px 2px rgba(0,0,0,0.03);
                        --shadow-md: 0 8px 16px -4px rgba(0,0,0,0.04), 0 4px 8px -2px rgba(0,0,0,0.02);
                        --shadow-hover: 0 20px 30px -8px rgba(0,0,0,0.08), 0 8px 12px -4px rgba(0,0,0,0.03);

                        --ease-out: cubic-bezier(0.25, 0.46, 0.45, 0.94);
                    }

                    * { box-sizing: border-box; }

                    .organogram-page {
                        font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
                        background-color: var(--bg-page);
                        height: 100vh;
                        display: flex;
                        flex-direction: column;
                        overflow: hidden;
                        color: var(--text-primary);
                    }

                    /* --- Header --- */
                    .page-header {
                        background: rgba(255, 255, 255, 0.85);
                        backdrop-filter: blur(12px);
                        border-bottom: 1px solid var(--border-color);
                        height: 72px;
                        padding: 0 32px;
                        display: flex;
                        justify-content: space-between;
                        align-items: center;
                        z-index: 50;
                        box-shadow: var(--shadow-sm);
                    }

                    .brand {
                        display: flex;
                        align-items: center;
                        gap: 12px;
                    }
                    .brand-icon {
                        width: 36px;
                        height: 36px;
                        background: var(--text-primary);
                        color: #fff;
                        border-radius: 8px;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                    }
                    .brand-text h2 {
                        margin: 0;
                        font-size: 1rem;
                        font-weight: 700;
                        letter-spacing: -0.02em;
                        line-height: 1.2;
                    }
                    .brand-text span {
                        font-size: 0.75rem;
                        color: var(--text-secondary);
                        font-weight: 500;
                        text-transform: uppercase;
                        letter-spacing: 0.05em;
                    }

                    .actions {
                        display: flex;
                        align-items: center;
                        gap: 24px;
                    }

                    /* Zoom */
                    .zoom-controls {
                        display: flex;
                        align-items: center;
                        background: #fff;
                        border: 1px solid var(--border-color);
                        border-radius: 8px;
                        padding: 4px;
                        box-shadow: var(--shadow-sm);
                    }
                    .zoom-controls button {
                        width: 32px;
                        height: 32px;
                        border: none;
                        background: transparent;
                        border-radius: 6px;
                        color: var(--text-secondary);
                        cursor: pointer;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        transition: all 0.15s;
                    }
                    .zoom-controls button:hover {
                        background: var(--bg-page);
                        color: var(--text-primary);
                    }
                    .zoom-level {
                        font-size: 0.8rem;
                        font-weight: 600;
                        width: 48px;
                        text-align: center;
                        font-variant-numeric: tabular-nums;
                    }
                    .separator {
                        width: 1px;
                        height: 16px;
                        background: var(--border-color);
                        margin: 0 4px;
                    }

                    .btn-login {
                        background: var(--text-primary);
                        color: #fff;
                        text-decoration: none;
                        padding: 10px 16px;
                        border-radius: 8px;
                        font-size: 0.9rem;
                        font-weight: 600;
                        display: flex;
                        align-items: center;
                        gap: 8px;
                        transition: all 0.2s;
                    }
                    .btn-login:hover {
                        background: #334155;
                        transform: translateY(-1px);
                    }

                    /* --- Canvas --- */
                    .canvas {
                        flex: 1;
                        overflow: auto;
                        padding: 80px 40px;
                        cursor: grab;
                        background-image:
                            radial-gradient(#e2e8f0 1px, transparent 1px);
                        background-size: 24px 24px;
                        user-select: none; /* Prevent text selection while dragging */
                    }
                    .canvas:active { cursor: grabbing; }
                    .canvas.grabbing { cursor: grabbing; }

                    .tree-wrapper {
                        display: flex;
                        justify-content: center;
                        width: max-content;
                        min-width: 100%;
                        transform-origin: top center;
                        transition: transform 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
                    }

                    .org-tree {
                        display: flex;
                        justify-content: center;
                        list-style: none;
                        padding: 0;
                        margin: 0;
                        position: relative;
                    }

                    .org-leaf {
                        position: relative;
                        padding: 60px 32px 0 32px;
                        display: flex;
                        flex-direction: column;
                        align-items: center;
                    }

                    /* --- Aggregate Box Layout --- */
                    .aggregate-box-wrapper {
                        padding-top: 60px;
                        display: flex;
                        flex-direction: column;
                        align-items: center;
                        position: relative;
                        width: 100%;
                    }

                    .connector-vertical-aggregate {
                        position: absolute;
                        top: 0;
                        left: 50%;
                        width: 2px;
                        height: 60px;
                        background-color: var(--line-color);
                        transform: translateX(-50%);
                        transition: background-color 0.2s;
                    }
                    .connector-vertical-aggregate.active {
                        background-color: var(--line-active);
                        animation: pulse-line 2s infinite ease-in-out;
                    }

                    .aggregate-box {
                        background: #fff;
                        border: 1px solid var(--border-color);
                        border-radius: 12px;
                        box-shadow: var(--shadow-md);
                        width: 100%;
                        max-width: 900px;
                        padding: 20px;
                        transition: border-color 0.2s, box-shadow 0.2s;
                    }
                    .aggregate-box.box-active {
                        border-color: var(--line-active);
                        box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.2), var(--shadow-md);
                    }

                    .aggregate-header h5 {
                        margin: 0 0 16px 0;
                        font-size: 0.95rem;
                        color: var(--text-secondary);
                        font-weight: 500;
                    }

                    .aggregate-grid {
                        display: grid;
                        grid-template-columns: repeat(3, 1fr);
                        gap: 16px;
                    }

                    .aggregate-footer {
                        margin-top: 16px;
                        display: flex;
                        justify-content: center;
                    }

                    .btn-view-more {
                        background: transparent;
                        border: none;
                        color: var(--line-active);
                        font-weight: 600;
                        cursor: pointer;
                        font-size: 0.9rem;
                    }
                    .btn-view-more:hover { text-decoration: underline; }

                    /* Compact User Card */
                    .compact-user-card {
                        display: flex;
                        align-items: center;
                        gap: 12px;
                        padding: 8px;
                        border-radius: 8px;
                        transition: background-color 0.2s;
                    }
                    .compact-user-card:hover {
                        background-color: #f8fafc;
                    }

                    .compact-avatar {
                        width: 36px;
                        height: 36px;
                        border-radius: 50%;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        font-weight: 600;
                        font-size: 0.85rem;
                        position: relative;
                        flex-shrink: 0;
                    }

                    .status-indicator {
                        position: absolute;
                        bottom: -2px;
                        right: -2px;
                        background: #fff;
                        border-radius: 50%;
                        display: flex;
                        padding: 1px;
                    }

                    .compact-info {
                        min-width: 0;
                    }

                    .compact-name {
                        font-weight: 600;
                        font-size: 0.9rem;
                        color: var(--text-primary);
                        white-space: nowrap;
                        overflow: hidden;
                        text-overflow: ellipsis;
                    }

                    .compact-role {
                        font-size: 0.8rem;
                        color: var(--text-secondary);
                        white-space: nowrap;
                        overflow: hidden;
                        text-overflow: ellipsis;
                    }

                    /* --- Grid Layout (For large teams > 8) --- */
                    .org-grid-wrapper {
                        display: grid;
                        grid-template-columns: repeat(3, 1fr); /* 3 Columns */
                        gap: 24px;
                        padding-top: 60px; /* Space for parent connector */
                        position: relative;
                        width: 100%;
                        max-width: 1200px;
                    }

                    /* Grid Parent Connector - Vertical Stem */
                    .org-grid-wrapper::before {
                        content: '';
                        position: absolute;
                        top: 0;
                        left: 50%;
                        width: 2px;
                        height: 32px; /* Slight overlap with bus bar */
                        background-color: var(--line-color);
                        transform: translateX(-50%);
                        transition: background-color 0.2s;
                    }

                    /* Grid Horizontal Bus Bar */
                    .org-grid-wrapper::after {
                        content: '';
                        position: absolute;
                        top: 30px; /* Starts where the stem ends */
                        left: 16.66%; /* Starts at the center of the first column (100/3/2 = 16.66) */
                        right: 16.66%; /* Ends at the center of the last column */
                        height: 2px;
                        background-color: var(--line-color);
                    }

                    .org-grid-wrapper.grid-active::before,
                    .org-grid-wrapper.grid-active::after {
                        background-color: var(--line-active);
                        animation: pulse-line 2s infinite ease-in-out;
                    }

                    .grid-item {
                        display: flex;
                        flex-direction: column;
                        align-items: center;
                        position: relative;
                    }

                    /* Grid Item Connections - Top Row Only */
                     .grid-item:nth-child(-n+3)::before {
                        content: '';
                        position: absolute;
                        top: -32px; /* Slight overlap with bus bar */
                        width: 2px;
                        height: 32px;
                        background-color: var(--line-color);
                        z-index: 0;
                     }

                     /* Grid Horizontal Connector (The 'Bus') */
                     /* We put a pseudo element on the grid items in the first row to connect them?
                        No, that's hard. Better to put a background line on the wrapper. */

                     .grid-item.grid-item-active::before {
                        background-color: var(--line-active);
                        animation: pulse-line 2s infinite ease-in-out;
                     }

                    /* Compact Card for Grid */
                    .card-grid {
                        width: 100%; /* Fill grid cell */
                        max-width: 320px;
                    }

                    /* --- Connectors (Legacy CSS Removed - Now SVG) --- */
                    /* We keep spacing/padding, but remove visual borders */

                    .org-tree::before { display: none; }
                    .org-leaf::before, .org-leaf::after { display: none; }
                    .connector-vertical { display: none; } /* Removed, handled by SVG */
                    .org-leaf > ul::before { display: none; }

                    /* Aggregate Box Connector - also removed, handled by SVG */
                    .connector-vertical-aggregate { display: none; }

                    /* Grid wrapper parent connectors also removed?
                       Wait, Grid layout inside Aggregate box is local.
                       The SVG handles Parent -> Box.
                       The lines INSIDE the box (Grid) are probably fine to keep CSS?
                       Or did we want those SVG too?
                       User asked for "The line passing through the gray line".
                       The user image showed the line OUTSIDE the box.
                       So we only need to replace the Tree Structure lines.
                       The Aggregate Grid lines are internal.
                    */

                    /* --- Card Styles --- */
                    .org-card {
                        background: var(--bg-card);
                        width: 280px;
                        position: relative;
                        border-radius: 12px;
                        box-shadow: var(--shadow-md);
                        transition: all 0.2s var(--ease-out);
                        cursor: pointer;
                        z-index: 2;
                        border: 1px solid transparent;
                        display: flex;
                        flex-direction: row;
                        outline: none;
                    }

                    /* Left Accent Bar */
                    .card-accent {
                        width: 5px;
                        height: 100%;
                        background-color: var(--dept-color);
                        flex-shrink: 0;
                    }

                    .card-body {
                        flex: 1;
                        padding: 14px 16px;
                        display: flex;
                        flex-direction: column;
                        gap: 10px;
                        border-radius: 0 12px 12px 0;
                    }

                    /* Hover State */
                    .org-card.state-active {
                        transform: scale(1.03);
                        box-shadow: var(--shadow-hover);
                        z-index: 50;
                        border-color: var(--line-active);
                    }

                    /* Focused State */
                    .org-card.state-focused {
                        transform: scale(1.03);
                        box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.3), var(--shadow-hover);
                        border-color: var(--line-active);
                        z-index: 50;
                    }

                    /* Subordinate State */
                    .org-card.state-subordinate {
                        transform: translateY(-2px);
                        box-shadow: var(--shadow-md);
                        background-color: #fff;
                        border: 1px solid var(--line-active);
                    }

                    /* Ancestor State */
                    .org-card.state-ancestor {
                         box-shadow: var(--shadow-md);
                    }

                    /* Dimmed State */
                    .org-card.state-dimmed {
                        opacity: 0.55;
                        filter: grayscale(0.6);
                        transform: scale(0.98);
                    }

                    /* Highlight (Search Match) */
                    .org-card.highlight {
                        background-color: #fffbeb;
                        border: 1px solid #f59e0b;
                    }

                    /* Header Layout */
                    .card-header {
                        display: flex;
                        align-items: center;
                        gap: 14px;
                    }

                    .avatar {
                        width: 42px;
                        height: 42px;
                        border-radius: 50%; /* Circular for modern look */
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        font-weight: 700;
                        font-size: 1rem;
                        flex-shrink: 0;
                        box-shadow: inset 0 0 0 1px rgba(0,0,0,0.05);
                    }

                    .info {
                        flex: 1;
                        min-width: 0;
                    }

                    .name {
                        margin: 0;
                        font-size: 1rem;
                        font-weight: 700;
                        color: var(--text-primary);
                        white-space: nowrap;
                        overflow: hidden;
                        text-overflow: ellipsis;
                        letter-spacing: -0.015em;
                        line-height: 1.2;
                    }

                    .role {
                        margin: 3px 0 0 0;
                        font-size: 0.85rem;
                        color: var(--text-secondary);
                        font-weight: 500;
                        display: -webkit-box;
                        -webkit-line-clamp: 2;
                        -webkit-box-orient: vertical;
                        overflow: hidden;
                        line-height: 1.35;
                    }

                    /* Footer */
                    .card-footer {
                        padding-top: 4px;
                        display: flex;
                    }

                    .dept-badge {
                        font-size: 0.7rem;
                        font-weight: 600;
                        padding: 3px 10px;
                        border-radius: 6px;
                        border: 1px solid;
                        text-transform: uppercase;
                        letter-spacing: 0.04em;
                        max-width: 100%;
                        white-space: nowrap;
                        overflow: hidden;
                        text-overflow: ellipsis;
                        background-color: transparent; /* Overridden inline */
                    }

                    /* Group Node */
                    .group-node {
                        height: 60px;
                        border: 1px dashed var(--line-color);
                        background: rgba(255,255,255,0.5);
                    }
                    .group-node:hover {
                        border-color: var(--line-active);
                        background: #fff;
                    }

                    /* Toggle Button */
                    .toggle-btn {
                        position: absolute;
                        bottom: -14px;
                        left: 50%;
                        transform: translateX(-50%);
                        width: 28px;
                        height: 28px;
                        background: #fff;
                        border: 1px solid var(--border-color);
                        border-radius: 50%;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        font-size: 0.8rem;
                        color: var(--text-secondary);
                        box-shadow: var(--shadow-sm);
                        transition: all 0.2s;
                        z-index: 5;
                    }
                    .toggle-btn:hover {
                        color: var(--text-primary);
                        border-color: var(--text-secondary);
                        transform: translateX(-50%) scale(1.1);
                    }
                    .toggle-btn.expanded .icon-chevron {
                        transform: rotate(180deg);
                        transition: transform 0.3s;
                    }

                    /* Loading / Error */
                    .loading-container, .error-container {
                        display: flex;
                        flex-direction: column;
                        align-items: center;
                        justify-content: center;
                        height: 100vh;
                        color: var(--text-secondary);
                        gap: 16px;
                    }
                    .spinner {
                        color: var(--text-primary);
                        animation: spin 1s linear infinite;
                    }
                    @keyframes spin { to { transform: rotate(360deg); } }

                    /* Tooltip */
                    .node-tooltip {
                        position: fixed;
                        background: #fff;
                        border: 1px solid var(--border-color);
                        border-radius: 8px;
                        padding: 16px;
                        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
                        z-index: 100;
                        pointer-events: auto; /* Allow clicking links */
                        width: max-content; /* Dynamic width */
                        max-width: 450px; /* Increased to accommodate long emails */
                        animation: fadeIn 0.2s ease-out;
                        color: var(--text-primary);
                    }
                    @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }

                    .tooltip-header {
                        font-weight: 600;
                        font-size: 0.9rem;
                        margin-bottom: 12px;
                        display: flex;
                        align-items: center;
                        gap: 4px;
                        color: #0f172a;
                    }

                    .tooltip-row {
                        display: flex;
                        align-items: center;
                        gap: 12px;
                        margin-bottom: 8px;
                        font-size: 0.9rem;
                    }
                    .tooltip-row:last-child { margin-bottom: 0; }

                    .icon-tooltip {
                        color: #64748b;
                        flex-shrink: 0;
                    }

                    .tooltip-link {
                        color: #2563eb; /* Blue-600 */
                        text-decoration: none;
                        white-space: normal; /* Allow wrapping if needed */
                        word-break: break-word; /* Break long emails */
                    }
                    .tooltip-link:hover {
                        text-decoration: underline;
                    }

                    .tooltip-text {
                        color: #334155; /* Slate-700 */
                        white-space: normal;
                        word-break: break-word;
                    }

                `})]})})};pe.createRoot(document.getElementById("root")).render(e.jsx(r.StrictMode,{children:e.jsx(tt,{})}));
