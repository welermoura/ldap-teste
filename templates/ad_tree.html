{% extends "base.html" %}
{% from "_macros.html" import render_page_header %}

{% block title %}Explorador do Active Directory{% endblock %}

{# O Flask injetará o caminho do arquivo CSS gerado pelo Vite aqui #}
{% block head %}
  {{ super() }}
  {% if css_file %}
  <link rel="stylesheet" href="{{ url_for('ad_tree_assets', filename=css_file.replace('assets/', '')) }}">
  {% endif %}
{% endblock %}

{% block page_title %}
    <div class="page-header mb-4">
        <h2><i class="fas fa-sitemap me-2"></i>Explorador do Active Directory</h2>
        <div class="page-actions d-flex align-items-center">
            <a href="{{ url_for('dashboard') }}" class="btn btn-outline-primary me-2"><i class="fas fa-home me-1"></i>Home</a>
            <a href="javascript:history.back()" class="btn btn-outline-secondary me-2"><i class="fas fa-arrow-left me-1"></i>Voltar</a>

            {% if session.ad_user %}
            <div class="dropdown me-2">
                <button class="btn btn-outline-secondary dropdown-toggle" type="button" id="userMenuButton" data-bs-toggle="dropdown" aria-expanded="false">
                    <i class="fas fa-user-circle me-1"></i>{{ session.user_display_name or 'Usuário' }}
                </button>
                <ul class="dropdown-menu dropdown-menu-dark dropdown-menu-end" aria-labelledby="userMenuButton">
                    <li><a class="dropdown-item" href="{{ url_for('logout') }}"><i class="fas fa-sign-out-alt me-2"></i>Sair</a></li>
                </ul>
            </div>
            {% endif %}

            <button id="theme-toggle" class="btn btn-outline-secondary" style="width: 40px; height: 40px; border-radius: 50%;">
                <i class="fas fa-moon"></i>
            </button>
        </div>
    </div>
{% endblock %}

{% block content %}
  {# Esta div é o ponto de montagem para a aplicação React #}
  <div class="card glass-card">
    <div class="card-body">
      <div id="root"></div>
    </div>
  </div>
{% endblock %}

{# O Flask injetará o caminho do arquivo JS gerado pelo Vite aqui #}
{% block scripts %}
  {{ super() }}
  {% if js_file %}
  <script type="module" src="{{ url_for('ad_tree_assets', filename=js_file.replace('assets/', '')) }}"></script>
  {% endif %}
{% endblock %}
