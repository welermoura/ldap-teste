{% extends "base.html" %}
{% from "_form_helpers.html" import render_field, render_submit_button %}
{% from "_macros.html" import render_log_table %}

{% block title %}Logs do Sistema - Admin{% endblock %}

{% block page_title %}
<div class="page-header">
    <h1><i class="fas fa-clipboard-list me-2"></i>Logs do Sistema</h1>
    <div>
        <a href="{{ url_for('dashboard') }}" class="btn btn-primary"><i class="fas fa-home me-2"></i>Home</a>
        <a href="{{ url_for('admin_dashboard') }}" class="btn btn-secondary"><i class="fas fa-arrow-left me-2"></i>Voltar ao Painel</a>
    </div>
</div>
{% endblock %}

{% block content %}
<div class="card glass-card mb-4">
    <div class="card-body">
        <form method="POST" action="{{ url_for('admin_logs') }}" class="d-flex">
            {{ search_form.hidden_tag() }}
            <div class="flex-grow-1 me-2">
                {{ render_field(search_form.search_query, placeholder="Filtrar por usuário, ação, etc.", label_visible=false) }}
            </div>
            {{ render_submit_button(search_form.submit, class="btn btn-primary btn-lg") }}
        </form>
    </div>
</div>

<div class="card glass-card">
    <div class="card-header">
        <ul class="nav nav-tabs card-header-tabs" id="logTabs" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="creation-tab" data-bs-toggle="tab" data-bs-target="#creation" type="button" role="tab" aria-controls="creation" aria-selected="true">
                    <i class="fas fa-plus-circle me-1"></i>Criação ({{ logs.creation|length }})
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="alteration-tab" data-bs-toggle="tab" data-bs-target="#alteration" type="button" role="tab" aria-controls="alteration" aria-selected="false">
                    <i class="fas fa-edit me-1"></i>Alteração ({{ logs.alteration|length }})
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="exclusion-tab" data-bs-toggle="tab" data-bs-target="#exclusion" type="button" role="tab" aria-controls="exclusion" aria-selected="false">
                    <i class="fas fa-trash-alt me-1"></i>Exclusão ({{ logs.exclusion|length }})
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="movement-tab" data-bs-toggle="tab" data-bs-target="#movement" type="button" role="tab" aria-controls="movement" aria-selected="false">
                    <i class="fas fa-people-arrows me-1"></i>Movimentação ({{ logs.movement|length }})
                </button>
            </li>
        </ul>
    </div>
    <div class="card-body p-0">
        <div class="tab-content" id="logTabsContent">
            <div class="tab-pane fade show active" id="creation" role="tabpanel" aria-labelledby="creation-tab">
                {{ render_log_table(logs.creation) }}
            </div>
            <div class="tab-pane fade" id="alteration" role="tabpanel" aria-labelledby="alteration-tab">
                {{ render_log_table(logs.alteration) }}
            </div>
            <div class="tab-pane fade" id="exclusion" role="tabpanel" aria-labelledby="exclusion-tab">
                {{ render_log_table(logs.exclusion) }}
            </div>
            <div class="tab-pane fade" id="movement" role="tabpanel" aria-labelledby="movement-tab">
                {{ render_log_table(logs.movement) }}
            </div>
        </div>
    </div>
</div>
{% endblock %}
